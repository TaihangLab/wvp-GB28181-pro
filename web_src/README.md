# 极星算法推理平台

> 一个基于Vue.js的可视化监控平台，用于展示算法推理系统的运行状态和数据统计。

## 项目概述

极星算法推理平台是一个大屏可视化系统，用于实时监控和展示AI算法推理引擎的各项性能指标、设备连接状态、报警事件等信息。该平台采用现代化设计风格，以蓝色科技感为主题，提供直观的数据可视化展示。

## 功能模块

### 太行智能助手
- **3D科技形象设计**：采用蓝色科技风格的立体化助手形象，具有呼吸光环、旋转光圈、科技粒子等动态效果
- **自由拖拽定位**：助手支持鼠标拖拽，可自由调整在页面中的位置，拖拽时具有特殊视觉反馈，拖拽时不会误触发对话框
- **智能自动隐藏**：助手在3秒无交互后自动隐藏到页面边缘，只露出一小部分，鼠标悬浮时立即显现
- **智能悬浮交互**：助手以圆形悬浮球形式显示，鼠标悬浮时放大并显示提示信息
- **精确点击控制**：只有鼠标点击时才会唤起对话框，拖拽操作不会误触发对话
- **对话式界面**：点击助手后弹出现代化对话框，支持文字输入和快捷提问
- **智能对话框定位**：对话框会根据助手位置智能调整显示方向，确保不超出屏幕边界
- **智能问答功能**：
  - 监控系统状态查询（设备在线率、资源使用情况等）
  - 设备配置指导（摄像头添加、参数设置等）
  - 预警管理帮助（处理流程、操作说明等）
  - 平台使用指导和技术支持
- **快捷操作管理**：提供常用问题的快捷按钮，支持一键关闭提示区域，避免重复显示
- **全平台覆盖**：在所有页面都显示，提供一致的用户体验
- **响应式设计**：支持桌面端和移动端的不同显示效果，窗口大小变化时自动调整位置

### 资源统计
- 显示服务器节点信息（Master节点和普通节点）
- 展示CPU、内存、磁盘、GPU等资源使用情况
- 使用环形图直观展示使用率百分比

### 算法管理
- 展示已部署的算法总数和运行状态
- 使用气泡图展示不同类型的算法
- 提供算法调用次数、推理速度、准确率等关键指标

### 设备监控
- 统计接入设备总数及各类设备数量
- 支持摄像头、算法服务器、NVR存储设备等多种设备类型
- 显示设备在线状态和关键性能参数

### 视觉AI技能管理
- 展示所有可用的视觉AI技能，如人体检测、车辆检测、人脸识别等
- 提供技能状态管理（已发布/未发布）
- 支持按技能类型和名称搜索筛选
- 显示技能版本和关联设备数量
- 提供技能详情查看和删除功能

### 报警事件
- 实时展示报警事件和现场图像
- 提供报警事件统计分析
- 支持按时间、类型进行数据筛选
- 图表化展示报警趋势

### 实时监控
- 支持实时视频流展示
- 多画面同时显示
- 智能识别结果可视化

### 预警管理
- 实时展示预警信息和处理状态
- 提供预警处理、档案管理、数据导出等功能

## 技术架构

- 前端框架：Vue.js
- UI组件：Element UI
- 可视化图表：Chart.js、自定义组件
- 3D效果：Three.js
- 智能助手：Vue.js自定义组件，采用CSS3动画和渐变效果
- 响应式设计：支持各种分辨率显示器

## 依赖说明

- **Chart.js**: 用于绘制报警趋势图和报警转发统计图
- **Element UI**: 提供基础UI组件
- **Three.js**: 用于中央3D数据可视化展示
- **Moment.js**: 用于时间格式化和处理
- **Echarts**: 提供复杂图表支持
- **Screenfull**: 实现全屏功能

## 项目结构

```
/
├── src/                    # 源代码目录
│   ├── components/         # 组件目录
│   │   ├── common/         # 通用组件
│   │   │   └── IntelligentAssistant.vue  # 太行智能助手组件
│   │   ├── visionAI/       # 视觉AI相关组件
│   │   │   └── ivisualCenter/  # 可视化中心组件
│   │   │       └── algorithmInference.vue  # 算法推理平台主组件
│   │   ├── assets/             # 静态资源
│   │   ├── router/             # 路由配置
│   │   ├── store/              # Vuex状态管理
│   │   ├── App.vue             # 应用入口组件
│   │   └── main.js             # 应用入口JS
├── public/                 # 公共资源目录
├── static/                 # 静态资源目录
│   └── img/                # 图片资源
│   │   ├── traffic.jpg     # 交通监控图片
│   │   ├── traffic-1.jpg   # 小型监控画面1
│   │   ├── traffic-2.jpg   # 小型监控画面2
│   │   ├── traffic-3.jpg   # 小型监控画面3
│   │   └── central-3d.png  # 中央3D数据可视化图
├── config/                 # 项目配置
├── build/                  # 构建脚本
└── package.json            # 项目依赖
```

## 安装与运行

```bash
# 安装依赖
npm install

# 开发模式运行（热重载）
npm run dev

# 生产环境构建
npm run build
```

## 界面设计

该项目采用蓝色科技风格设计，包含以下设计元素：
- 深蓝色背景，营造科技感
- 渐变色边框和装饰线条
- 数据可视化图表（环形图、折线图、条形图等）
- 3D立体数据展示
- 实时数据流动效果
- 气泡效果算法展示

### 图表说明

- **资源使用率图表**: 使用CSS实现的环形进度图，展示CPU、内存、磁盘和GPU使用率
- **算法气泡图**: 使用动画效果展示各种算法，并带有浮动效果
- **报警趋势图**: 使用Chart.js实现的折线图，展示一个月内每天的报警数量趋势
- **报警类型统计**: 使用环形图展示不同类型报警的占比情况
- **报警转发统计**: 使用Chart.js实现的柱状图，展示不同月份的报警转发数量
- **设备类型统计**: 使用CSS实现的环形图，展示不同类型设备的数量

## 最近更新内容

### 界面重构
- 完全重新设计了UI界面，采用更专业的数据可视化风格
- 优化了布局结构，更合理地组织信息展示
- 调整了色彩方案，提高了视觉层次感和可读性
- 添加了中央3D数据可视化效果
- **新增太行智能助手**：设计了具有科技感的3D立体助手形象，支持智能问答和操作指导，提升用户体验和使用便利性

### 功能增强
- 增加了更多数据统计维度
- 优化了报警信息展示方式
- 添加了设备总览和分类统计
- 改进了算法性能指标展示
- 集成了Chart.js提升图表展示效果
- 新增视觉AI技能管理模块，支持技能状态管理和搜索功能
- **新增预警详情页面违规描述字段**：在预警详情弹窗中增加了违规描述信息，提供更详细的违规行为说明和处理建议，提升预警信息的完整性和实用性，同时优化了信息展示布局，将违规类型调整为预警名称，新增预警类型分类，并改进了预警描述的文本对齐方式
- **预警管理功能重构**：根据产品需求重新设计了预警处理操作流程，包括：
  - 将原有的"处理"和"完结"按钮简化为"标记为已处理"功能，一键直接将预警状态改为已处理
  - 新增"添加备注"功能，支持录入处理意见、责任人和处置方式等详细信息
  - 优化"上报"功能，点击后弹窗显示"预警已上报"确认信息
  - **新增"误报"功能**：一键标记误报预警并自动归档到默认档案，误报预警从实时监控和管理页面消失，仅可在档案中查看
  - 新增"归档"功能，将预警从管理列表中正式移除并归入档案
  - 预警卡片中增加备注信息展示，方便查看历史处理记录
  - 批量处理功能调整为批量标记为已处理，提高操作效率
  - **按钮布局优化**：调整预警卡片底部按钮大小为mini尺寸，确保所有操作按钮能在一行内整齐排列，提升界面美观度和操作便利性
- **智能归档系统实现**：完整实现了基于摄像头位置的档案选择逻辑，包括：
  - 档案选择逻辑：当前位置有默认档案时自动选择，无默认档案时系统自动创建
  - 限制条件：用户只能选择当前摄像头位置的档案，不可跨摄像头归档
  - 自定义档案：支持用户创建新档案，可输入档案名称和描述信息
  - 状态管理：归档后预警状态变为"已归档"，从实时预警和管理页面移除
  - 档案关联：每个预警归档时记录归档时间和所属档案ID，便于后续查询
  - 用户体验：提供清晰的操作界面和状态提示，确保归档操作的准确性
- **位置区域筛选功能**：在预警管理页面左侧新增位置区域导航，实现按位置筛选预警信息：
  - 位置分类：支持全部位置、油气监控区域、作业区域、储罐区域、管道区域、管道接口等位置筛选
  - 实时计数：每个位置显示当前未归档预警的实时数量统计
  - 智能筛选：点击位置后自动筛选显示该位置的预警信息，提高查看效率
  - 状态管理：切换位置时自动清空已选择的预警项和筛选状态
  - 用户反馈：选择位置时提供成功提示信息，增强用户体验
  - 响应式设计：支持桌面端和移动端不同的显示方式，确保各种设备下的最佳展示效果
  - 现代UI设计：采用渐变色、圆角卡片、悬浮效果等现代设计元素，与整体页面风格保持一致
- **预警卡片布局优化**：调整预警信息卡片布局为一行显示5个卡片，提高信息展示密度和屏幕利用率：
  - 桌面端：一行显示5个预警卡片，充分利用宽屏显示空间
  - 中等屏幕：一行显示4个预警卡片，保持良好的视觉效果
  - 移动端：一行显示2个预警卡片，确保移动设备上的可读性
  - 响应式适配：根据不同屏幕尺寸自动调整卡片数量和间距
  - 比例优化：将卡片高度从320px调整为360px，图片区域从120px调整为140px，使卡片宽高比例更加协调美观
- **预警详情处理进展时间线重构**：将固定的处理状态流程改为动态的操作历史记录系统：
  - **动态操作记录**：不再使用固定的处理状态时间线，改为实时记录每一次对预警的操作
  - **完整操作历史**：记录所有操作类型，包括预警产生、处理记录、上报、归档、误报处理等
  - **多次操作支持**：允许用户多次点击不同的操作按钮，每次操作都会在时间线中添加新的记录
  - **多次处理记录**：处理按钮可重复点击，每次点击都会添加一条新的处理记录，而不是将预警标记为"已处理"状态
  - **操作员信息**：每条操作记录显示操作员信息，便于追溯责任人
  - **操作时间记录**：精确记录每次操作的执行时间，形成完整的操作时间轴
  - **操作类型标识**：使用不同颜色的左边框区分不同操作类型（创建-灰色、处理-绿色、上报-橙色、归档-红色、误报-灰色）
  - **操作描述详情**：每条记录包含详细的操作描述，如处理意见、归档位置、上报信息等
  - **状态持久化**：操作历史保存在预警对象中，重新打开详情页面时能完整加载历史记录
  - **用户体验优化**：操作后不自动关闭详情弹框，用户可继续查看更新后的时间线或进行其他操作
  - **视觉设计优化**：优化时间线样式，增加操作类型标识和操作员信息显示，提升可读性和美观度
  - **固定高度滚动**：处理进展框设置固定高度（470px），与左侧媒体内容底边对齐，多余的时间线记录通过滚动查看
  - **用户昵称显示**：操作员信息显示真实的用户登录昵称，而不是固定的"当前用户"文本，支持从localStorage保存和获取用户昵称
  - **时间线视觉优化**：最新的时间线项目（第一个）使用动态蓝色圆点突出显示，带有呼吸灯效果，其他历史项目使用灰色圆点，便于区分操作的新旧顺序
- **预警档案信息字段完善**：优化预警档案模块中添加预警功能，使其信息字段与预警详情页面完全匹配：
  - **新增预警类型字段**：增加安全违规、人员违规、消防违规、车辆违规、其他违规等类型选择（必填项）
  - **新增违规位置字段**：支持填写具体的违规发生位置（必填项）
  - **新增处理备注字段**：允许录入处理情况、整改措施等备注信息
  - **优化预警描述字段**：从简单的"备注描述"升级为详细的"预警描述"，支持更完整的违规行为描述
  - **新增预警时间字段**：增加时间选择器，支持精确到秒的预警发生时间记录，确保时间信息的准确性（必填项）
  - **新增违规截图上传**：支持上传违规现场截图，限制图片格式和大小（2MB以内），采用现代化拖拽上传UI设计
  - **新增视频片段上传**：支持上传违规行为视频片段，限制视频格式和大小（10MB以内），提供直观的视频预览界面
  - **数据结构统一**：确保添加的预警记录包含所有必要字段，与预警详情页面显示的信息完全对应
  - **模拟数据增强**：为历史档案数据补充完整的字段信息，包括预警类型、违规位置、处理备注等
  - **表单验证升级**：强化必填字段验证，包括预警名称、设备名称、预警等级、预警时间、预警类型、违规位置
  - **界面布局优化**：采用双列布局提高表单填写效率，增大弹框宽度至50%，提升用户体验
  - **UI设计改进**：重新设计文件上传组件，采用渐变背景、毛玻璃效果、悬浮动画等现代化视觉元素，提升用户交互体验
  - **图片预览功能优化**：修复预警图片预览功能，包括表格中小图片缩略图显示、点击预览大图功能、图片预览弹框样式优化，确保图片能正确加载和显示，提升用户查看预警图片的体验
- **技能编辑权限控制**：实现了技能上线状态下的编辑权限控制，确保数据安全和业务流程的合规性：
  - **卡片编辑按钮状态控制**：已上线技能的编辑按钮自动禁用并显示"已上线技能不可编辑"提示

## 太行智能助手使用指南

### 助手特色功能
太行智能助手是专为太行AI云平台设计的智能对话助手，具有以下特色：

#### 视觉设计特点
- **3D立体形象**：采用蓝色科技风格，具有双层旋转光圈和呼吸光环效果
- **动态科技粒子**：助手周围环绕着浮动的科技粒子，营造未来感
- **眨眼动画**：助手具有拟人化的眨眼效果，增加亲和力
- **悬浮交互**：鼠标悬浮时助手会放大并显示提示信息

#### 交互方式
1. **悬浮状态**：助手以60px的圆形悬浮球形式显示，初始位置在页面右下角
2. **自动隐藏**：3秒无交互后助手自动隐藏到页面边缘，只露出20px，节省屏幕空间
3. **悬浮显现**：鼠标悬浮时助手立即从边缘完全显现，并显示"太行智能助手"提示
4. **自由拖拽**：鼠标按下助手球可进行拖拽，调整到任意位置，拖拽时有特殊视觉反馈
5. **精确点击**：只有鼠标点击时才会唤起对话框，拖拽操作不会误触发对话
6. **智能定位**：对话框会根据助手位置自动选择在左侧或右侧显示
7. **对话交互**：支持文字输入和快捷提问，快捷提示可一键关闭
8. **状态管理**：对话框打开时助手保持完全显示，关闭后重新开始3秒隐藏计时

#### 智能问答能力
智能助手具备以下问答能力：

**监控系统相关**
- 系统运行状态查询
- 设备在线率统计
- 资源使用情况（CPU、内存、磁盘、GPU）
- 离线设备检查建议

**设备管理相关**
- 摄像头设备添加流程
- 设备配置参数说明
- 连接测试指导
- 设备故障排查

**预警管理相关**
- 预警处理流程说明
- 档案管理操作指导
- 预警类型解释
- 处理状态说明

**平台使用相关**
- 功能模块介绍
- 操作指导
- 技术支持
- 帮助文档引导

#### 快捷操作
对话框提供三个快捷提问按钮：
- "监控系统实时状态如何？"
- "如何新增摄像头监控设备？"
- "预警信息如何管理和处理？"

#### 技术实现
- **组件路径**：`src/components/common/IntelligentAssistant.vue`
- **集成方式**：通过主布局文件 `src/layout/index.vue` 全局引入
- **样式技术**：CSS3动画、渐变、毛玻璃效果、响应式设计
- **拖拽技术**：原生JavaScript拖拽事件、位置计算、边界限制、拖拽状态检测
- **自动隐藏算法**：定时器管理、位置判断、智能隐藏方向选择
- **点击识别**：拖拽与点击事件分离，防止误触发机制
- **定位算法**：动态计算对话框位置，防止超出屏幕边界
- **状态管理**：Vue.js计算属性、响应式状态、多状态协调
- **交互技术**：Vue.js响应式数据、事件处理、组件通信、生命周期管理

#### 响应式适配
- **桌面端**：对话框宽度380px，完整功能展示
- **中等屏幕**：适配平板设备，保持良好的交互体验
- **移动端**：对话框宽度320px，助手位置自动调整

### 使用建议
1. **位置调整**：首次使用可将助手拖拽到习惯的位置，助手会根据位置智能选择隐藏方向
2. **自动隐藏特性**：助手会在3秒后自动隐藏到边缘，需要时鼠标悬浮即可显现
3. **快捷操作**：建议先点击快捷提问按钮体验智能问答功能，之后可关闭提示区域
4. **拖拽技巧**：拖拽时不会误触发对话框，可以放心调整位置到合适的地方
5. **复杂问题**：对于复杂操作，助手会提供分步骤的详细指导
6. **专业支持**：如助手无法解答的问题，会引导联系技术支持团队
7. **位置适配**：在不同屏幕尺寸下，建议将助手放在便于悬浮访问且不遮挡主要内容的位置
8. **定期更新**：助手的知识库会根据平台功能更新持续优化

太行智能助手旨在提供7×24小时的智能服务，帮助用户更高效地使用太行AI云平台的各项功能。
- **预警详情API集成 (2024-12-18)**：完成了预警管理页面的API集成，实现了完整的预警详情获取功能：
  - **API接口调用**：在预警管理页面点击预警卡片时，系统会调用`/api/v1/alerts/{alert_id}`接口获取完整的预警详情
  - **完整信息展示**：支持显示完整的预警信息，包括检测结果、电子围栏、视频片段、处理流程等
  - **数据格式适配**：自动处理API返回的处理流程信息，生成完整的操作历史时间线
  - **媒体资源支持**：支持真实的图片URL (minio_frame_url) 和视频URL (minio_video_url) 展示
  - **检测结果可视化**：展示AI检测结果，包括检测物体类型、置信度、位置坐标等详细信息
  - **电子围栏信息**：显示电子围栏配置，包括围栏点坐标、触发模式等参数
  - **技能关联信息**：展示相关的AI技能信息，包括技能ID、技能名称等
  - **处理状态同步**：根据API返回的状态信息，自动同步预警的处理状态和操作历史
  - **错误处理机制**：API调用失败时自动降级到本地数据展示，确保用户体验的连续性
  - **数据缓存优化**：将API返回的完整数据保存在预警对象中，避免重复请求提升性能
- **视频播放器修复 (2024-12-18)**：完成了预警详情页面视频播放功能的重构和修复：
  - **真实视频播放**：将静态图片展示替换为HTML5 video元素，支持真实的视频播放
  - **API数据适配**：修复响应拦截器，将预警详情接口标记为特殊API，保持原始数据结构
  - **视频URL支持**：正确处理API返回的minio_video_url字段，支持MinIO存储的视频文件
  - **播放控制优化**：实现真实的播放/暂停、进度条拖拽、音量控制等视频播放功能
  - **加载状态处理**：添加视频加载完成、播放错误等状态的处理机制
  - **兼容性保障**：同时支持图片和视频的展示，无媒体数据时显示友好的占位符
  - **调试信息增强**：添加详细的控制台日志，便于问题排查和功能验证
- **预警管理API集成**：完成了预警管理系统与后端API的集成，实现了真实数据的获取和操作：
  - **实时预警API集成**：接入`/api/v1/alerts/real-time`接口，支持服务端分页查询和多维度筛选（日期范围、预警等级、预警类型、设备、位置、状态等）
  - **服务端分页优化**：移除前端过滤逻辑，完全依赖API服务端分页，支持大数据量高效展示，分页切换时自动重新获取数据
  - **分页功能修复**：修复分页组件功能失效问题，确保页码切换和每页数量变更时正确调用API重新获取数据
  - **数据显示完整性**：解决数据显示不全问题，确保API返回的所有数据都能正确展示在页面上
  - **预警状态管理API**：集成预警状态更新接口，支持处理中、已处理等状态的实时更新
  - **批量操作API**：实现批量处理、批量删除预警的API调用，提高操作效率
  - **数据格式转换**：建立完善的API数据与页面数据的转换机制，确保后端数据能正确映射到前端展示组件
  - **错误处理机制**：增加详细的错误处理和用户提示，包括网络异常、API错误等情况的友好提示
  - **操作历史同步**：将API返回的处理步骤信息转换为页面的操作历史时间线显示
  - **分页信息同步**：API返回的分页信息与前端分页组件完全同步，支持总数、当前页、每页数量等参数的双向绑定
  - **筛选条件映射**：建立前端筛选表单与API查询参数的完整映射关系，确保所有筛选条件都能正确传递给后端
  - **兼容性处理**：保留模拟数据作为API异常时的降级方案，确保页面在网络故障时仍能正常展示
- **预警详情API集成**：完成了预警详情对话框与后端API的深度集成，支持通过ID动态获取预警详情：
  - **单个预警详情API**：接入`/api/v1/alerts/{alert_id}`接口，根据预警ID获取完整的预警详情和处理流程信息
  - **灵活的数据获取方式**：支持两种模式 - 传入完整预警对象（现有模式）或传入预警ID自动获取详情（新增模式）
  - **API数据转换增强**：扩展数据转换机制，支持API详情数据到页面展示格式的完整转换，包括检测结果、电子围栏、技能信息等
  - **操作历史API集成**：将API中的`process`流程信息转换为页面时间线展示，支持处理步骤、操作人员、时间等完整信息
  - **状态同步机制**：根据API返回的预警状态（待处理、处理中、已处理）自动生成对应的操作历史记录
  - **媒体资源支持**：集成`minio_frame_url`和`minio_video_url`，支持预警截图和视频的完整展示
  - **向后兼容**：保持与现有调用方式的完全兼容，既支持传统的预警对象传递，也支持新的ID获取模式
  - **错误处理完善**：增加详细的错误处理机制，包括数据缺失、网络异常、API错误等情况的友好提示
  - **数据结构扩展**：支持API返回的扩展字段，如检测结果`result`、电子围栏`electronic_fence`、技能信息等
  - **方法级状态检查**：在editSkill方法中增加技能状态检查，已上线技能无法进入编辑模式
  - **删除权限控制**：已上线技能的删除按钮同样禁用，防止误删除重要的线上技能
  - **批量删除保护**：批量删除时自动过滤已上线技能，并提示用户哪些技能无法删除
  - **详情页编辑控制**：技能详情页面仅在未上线状态下显示"编辑技能"按钮
  - **路由模式保护**：如果通过URL直接访问已上线技能的编辑模式，系统自动切换到查看模式
  - **数据管理器级别保护**：在skillDataManager中增加状态检查，从数据层面防止已上线技能被误删除
  - **用户体验优化**：提供清晰的状态提示和禁用样式，让用户明确了解操作限制原因
  - **业务流程规范**：确保技能必须先下线才能进行编辑或删除，维护线上环境的稳定性
- **技能复制功能实现**：完整实现了技能复制功能，支持一键复制生成新技能：
  - **智能命名系统**：自动生成复制技能名称，支持多种数字后缀格式（如：技能名1、技能名-1、技能名_1、技能名 1等）
  - **名称去重机制**：自动检测已存在的技能名称，确保复制后的技能名称唯一性，避免命名冲突
  - **数字递增算法**：智能识别现有技能名称的数字后缀，自动递增生成新的后缀编号
  - **独立ID生成**：为复制的技能生成全新的唯一ID，确保数据库记录的独立性
  - **状态重置**：复制的技能默认设置为"未上线"状态，符合业务流程规范
  - **确认提示框**：提供专业的确认对话框，明确告知用户复制操作的具体行为和结果
  - **自定义UI设计**：定制化的确认对话框样式，包含警告图标、圆角设计、阴影效果等现代化视觉元素
  - **操作反馈**：提供清晰的成功、失败和取消操作提示，确保用户了解操作结果
  - **数据同步**：复制操作完成后自动更新技能列表，立即显示新增的复制技能
  - **取消保护**：用户取消复制操作时提供友好提示，避免意外操作造成的困扰

### 交互优化
- 添加了日期选择器，支持时间范围筛选
- 优化了图表展示效果
- 增加了全屏显示功能
- 改进了实时事件展示和通知
- 添加了图表交互功能，支持鼠标悬停显示详细数据
- 优化了技能卡片布局，提升了视觉体验
- 增加了技能卡片悬浮效果和操作按钮

## 使用说明

1. 主界面展示各类数据统计和实时状态
2. 通过顶部导航可切换不同功能模块
3. 单击图表和数据卡片可查看详细信息
4. 右上角全屏按钮可切换全屏显示模式
5. 报警信息面板可通过日期按钮筛选不同时间段的数据
6. 实时事件面板显示最新的报警事件和图像
7. 在视觉AI技能管理页面，可以：
   - 使用顶部筛选器按状态和类型筛选技能
   - 使用搜索框搜索特定技能名称
   - 点击技能卡片上的"详情"按钮查看技能详细信息
   - 点击技能卡片上的"删除"按钮删除不需要的技能

## 后续计划

- [ ] 添加用户权限管理
- [ ] 优化移动端适配
- [ ] 增加更多自定义配置选项
- [ ] 支持更多类型的数据可视化图表
- [ ] 添加国际化支持
- [ ] 优化3D数据展示效果
- [ ] 增加更多交互功能

## 页面宽度优化

为了提供更好的全屏展示效果，系统进行了整体宽度优化，主要包含以下修改：

### 全宽布局优化
- 修改了主要容器元素，设置宽度为100%，确保页面内容充分利用屏幕空间
- 移除了页面元素的左右padding，消除两侧空白区域
- 调整了导航栏样式，确保导航栏横跨整个屏幕宽度

### 样式调整
- 添加了`overflow-x: hidden`属性防止水平滚动条出现
- 所有主要容器元素(el-container, el-header, el-main)均设置为宽度100%
- 调整了page-header样式，确保标题栏也能横跨整个屏幕

### 控制台页面优化
- 控制台页面各监控模块进行了布局调整，确保在全屏模式下正确显示
- 优化了row和col的间距，提供更紧凑的布局

### 实现效果
- 页面内容完全充满整个屏幕宽度
- 导航栏和内容区域不再有两侧留白
- 在各种分辨率下都能提供更好的视觉体验

# 太行AI云平台 - 实时预警功能

## 项目概述

本项目是太行AI云平台的前端部分，基于Vue.js开发，主要实现了智能监控和实时预警功能。项目采用科技感UI设计，提供了完整的视频监控、设备管理、AI算法管理等功能模块。

## 🔥 重要更新 - 实时预警功能修复

### 问题描述
实时预警页面虽然显示"已连接"，但收到新预警时页面不会自动更新。

### 🔧 修复内容 (2024-12-19)

#### 1. SSE连接端点修复 ✅
- **问题**：前端使用了错误的SSE连接URL和参数
- **修复前**：`api/emit?browserId=${browserId}` （WVP传统报警端点，需要浏览器ID参数）  
- **修复后**：`http://192.168.1.106:8000/api/v1/alerts/stream` （AI预警专用端点，无需参数）

#### 2. 连接参数优化 ✅
- **移除不必要的 browserId 参数**：AI后端SSE端点不需要浏览器标识符
- **简化连接逻辑**：直接连接到AI预警流，无需额外参数验证
- **修复前端调用**：更新 `initSSEConnection()` 方法，移除浏览器ID依赖

#### 3. 消息处理逻辑优化 ✅
- 更新了 `VisionAIService.js` 中的 `createAlertSSEConnection` 方法
- 优化了实时预警页面的 `handleSSEMessage` 方法
- 添加了详细的调试日志，便于问题排查

#### 4. 数据格式兼容 ✅
- 保留了完整的 `convertAPIWarningToFrontend` 数据转换方法
- 支持多种预警类型和等级的正确映射
- 确保新预警能正确显示在实时监控界面

### 🔥 重大更新 - SSE连接代码完全重写 (2024-12-19)

#### ❌ 之前的问题
- 复杂的重连逻辑导致连接不稳定
- 一直显示"重连中..."状态
- 连接打开后立即关闭

#### ✅ 彻底重写
**删除了所有复杂逻辑：**
- `scheduleReconnect()` - 删除自动重连机制
- `handleSSEError()` - 简化错误处理
- `handleSSEClose()` - 简化关闭处理
- `sseStatus` 复杂状态管理 - 只保留基本连接状态

**新的简化架构：**
```javascript
// VisionAIService.js - 极简SSE连接
createAlertSSEConnection(onMessage, onError, onClose) {
  const sseUrl = `${visionAIAxios.defaults.baseURL}/api/v1/alerts/stream`;
  const eventSource = new EventSource(sseUrl);
  
  eventSource.onopen = () => console.log('SSE连接已建立');
  eventSource.onmessage = (event) => onMessage(JSON.parse(event.data));
  eventSource.onerror = (event) => onError(event);
  
  return eventSource;
}
```

#### 🎯 现在的体验
- **连接更稳定**：无复杂重连逻辑干扰
- **状态更清晰**：只显示"已连接"或"未连接"
- **性能更好**：减少了90%的复杂代码

### ✅ 修复验证
现在SSE连接应该非常稳定，不再出现"重连中"的状态循环。

### 🚀 使用指南

#### 实时预警功能
1. 进入"监控预警" → "实时监控"页面
2. 查看右上角SSE连接状态指示器：
   - 🟢 绿色：已连接，可接收实时预警
   - 🟡 黄色：重连中
   - 🔴 红色：连接失败
3. 当有新预警产生时，会自动在右侧预警列表中显示
4. 支持预警详情查看和状态处理

#### 调试功能
页面右上角提供调试工具：
- **刷新预警数据**：手动刷新预警列表
- **发送测试预警**：生成测试预警验证功能
- **重连SSE**：手动重新建立SSE连接
- **查看SSE状态**：查看连接详细状态信息

### 🔧 技术架构

#### SSE实时推送流程
```
AI任务执行器 → RabbitMQ → AlertService → SSE连接管理器 → 前端实时预警页面
```

#### 关键文件
- `src/components/service/VisionAIService.js` - API服务封装
- `src/components/visionAI/monitoringWarning/realTimeMonitoring.vue` - 实时监控页面
- `smart_engine/app/api/alerts.py` - 后端预警API
- `smart_engine/app/services/alert_service.py` - 预警服务逻辑

## 主要功能模块

### 1. 视觉AI管理
- **设备管理**：摄像头设备的添加、配置和管理
- **技能管理**：AI检测技能的配置和部署
- **模型管理**：AI模型的加载、卸载和版本管理

### 2. 监控预警系统
- **实时监控**：多分屏视频监控界面
- **实时预警**：基于SSE的实时预警推送 ✅ 已修复
- **预警管理**：历史预警的查询、处理和统计
- **智能审核**：预警结果的人工审核和标注

### 3. 系统管理
- **应用设置**：系统参数配置
- **日志记录**：操作日志和系统日志查看

## 开发环境

### 技术栈
- Vue.js 2.x
- Element UI
- Axios (HTTP客户端)
- WebRTC (视频播放)
- Server-Sent Events (实时推送)

### 环境要求
- Node.js >= 14.0
- npm >= 6.0

### 启动开发环境
```bash
npm install
npm run dev
```

### 构建生产版本
```bash
npm run build
```

## 配置说明

### API服务配置
在 `src/components/service/VisionAIService.js` 中配置后端服务地址：
```javascript
const visionAIAxios = axios.create({
  baseURL: 'http://192.168.1.106:8000',  // 后端服务地址
  timeout: 15000,
  withCredentials: false
});
```

### SSE连接配置
实时预警SSE连接配置：
```javascript
// AI预警专用SSE端点
const sseUrl = `http://192.168.1.106:8000/api/v1/alerts/stream`;
```

## 故障排除

### 实时预警不更新
1. 检查SSE连接状态指示器
2. 查看浏览器控制台是否有连接错误
3. 确认后端服务 `http://192.168.1.106:8000` 可访问
4. 使用调试功能发送测试预警验证

### API请求失败
1. 检查网络连接
2. 确认后端服务状态
3. 查看浏览器网络面板的具体错误信息

## 更新日志

### v1.2.0 (2024-12-19) 🔥
- **[重要修复]** 实时预警SSE连接端点错误问题
- **[优化]** SSE消息处理逻辑和错误处理
- **[新增]** 详细的调试日志和状态指示器
- **[验证]** 通过测试预警验证修复效果

### v1.1.0
- 集成AI视觉识别功能
- 实现设备和技能管理
- 添加实时监控界面

### v1.0.0
- 初始版本发布
- 基础的设备管理功能

## 联系方式
如有问题请联系技术支持团队。
